# Path - Public PATH additions
# Add machine-specific paths to ~/.local/dotfiles/path.local

# ------------------------------------------------------------------------------
# Helper function to add to PATH (avoids duplicates)
# ------------------------------------------------------------------------------

path_prepend() {
    if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
        export PATH="$1:$PATH"
    fi
}

path_append() {
    if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
        export PATH="$PATH:$1"
    fi
}

# ------------------------------------------------------------------------------
# Homebrew (macOS only)
# ------------------------------------------------------------------------------

if [[ "$OSTYPE" == "darwin"* ]]; then
    if [[ -f "/opt/homebrew/bin/brew" ]]; then
        eval "$(/opt/homebrew/bin/brew shellenv)"
    elif [[ -f "/usr/local/bin/brew" ]]; then
        eval "$(/usr/local/bin/brew shellenv)"
    fi
fi

# ------------------------------------------------------------------------------
# Linuxbrew (Linux only, if installed)
# ------------------------------------------------------------------------------

if [[ "$OSTYPE" == "linux"* ]]; then
    if [[ -f "/home/linuxbrew/.linuxbrew/bin/brew" ]]; then
        eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
    elif [[ -f "$HOME/.linuxbrew/bin/brew" ]]; then
        eval "$("$HOME/.linuxbrew/bin/brew" shellenv)"
    fi
fi

# ------------------------------------------------------------------------------
# Standard paths
# ------------------------------------------------------------------------------

path_prepend "$HOME/.local/bin"
path_prepend "$HOME/bin"

# ------------------------------------------------------------------------------
# Development tools
# ------------------------------------------------------------------------------

# Cargo (Rust)
path_prepend "$HOME/.cargo/bin"

# Go
path_prepend "$HOME/go/bin"

# Node.js (if using volta or nvm, this may be managed elsewhere)
path_prepend "$HOME/.npm-global/bin"

# Bun global packages
path_prepend "$HOME/.cache/.bun/bin"
path_prepend "$HOME/.bun/bin"

# ------------------------------------------------------------------------------
# Trusted binstubs (macOS pattern)
# mkdir .git/safe in the root of repositories you trust
# ------------------------------------------------------------------------------

path_prepend ".git/safe/../../bin"
